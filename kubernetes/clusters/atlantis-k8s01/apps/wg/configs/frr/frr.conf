frr version 10.5
frr defaults traditional
hostname wg-router
log syslog informational
service integrated-vtysh-config

router bgp 64592
 bgp router-id {{ .vlan200_address_v4 }}
 no bgp ebgp-requires-policy
 neighbor 10.66.2.252 remote-as 64567
 neighbor 10.66.2.252 description nexus-core01a
 neighbor 10.66.2.253 remote-as 64567
 neighbor 10.66.2.253 description nexus-core01b
 neighbor fd66::2:c01a remote-as 64567
 neighbor fd66::2:c01a description nexus-core01a-v6
 neighbor fd66::2:c01b remote-as 64567
 neighbor fd66::2:c01b description nexus-core01b-v6

 address-family ipv4 unicast
  network 0.0.0.0/0
  neighbor 10.66.2.252 activate
  neighbor 10.66.2.253 activate
  no neighbor fd66::2:c01a activate
  no neighbor fd66::2:c01b activate
 exit-address-family

 address-family ipv6 unicast
  network ::/0
  no neighbor 10.66.2.252 activate
  no neighbor 10.66.2.253 activate
  neighbor fd66::2:c01a activate
  neighbor fd66::2:c01b activate
 exit-address-family
exit

ip route 0.0.0.0/0 blackhole
ipv6 route ::/0 blackhole

! OSPF for WireGuard HA - advertise VLAN 201 to Tortuga
router ospf
 ospf router-id {{ .tunnel_address_v4 }}
 timers throttle spf 50 100 1000
 ! Redistribute kernel route to 10.66.1.0/24 (added by WG PostUp)
 redistribute kernel
 passive-interface default
 no passive-interface wg0

interface wg0
 ip ospf area 0
 ip ospf network point-to-point
 ip ospf hello-interval 2
 ip ospf dead-interval 6

! OSPFv3 for IPv6
router ospf6
 ospf6 router-id {{ .tunnel_address_v4 }}
 timers throttle spf 50 100 1000
 redistribute kernel

interface wg0
 ipv6 ospf6 area 0
 ipv6 ospf6 network point-to-point
 ipv6 ospf6 hello-interval 2
 ipv6 ospf6 dead-interval 6
